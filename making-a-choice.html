<!DOCTYPE html>
<html lang="en">
<head>
        <meta charset="utf-8" />
        <title>Choosing the best variant</title>
        <link rel="stylesheet" href="/theme/css/main.css" />

        <!--[if IE]>
            <script src="https://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
        <![endif]-->
</head>

<body id="index" class="home">
        <header id="banner" class="body">
                <h1><a href="/">And yet it moves! </a></h1>
                <nav><ul>
                    <li class="active"><a href="/category/data-processing.html">Data processing</a></li>
                </ul></nav>
        </header><!-- /#banner -->
<section id="content" class="body">
  <article>
    <header>
      <h1 class="entry-title">
        <a href="/making-a-choice.html" rel="bookmark"
           title="Permalink to Choosing the best variant">Choosing the best&nbsp;variant</a></h1>
    </header>

    <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2016-05-14T14:41:00+01:00">
                Published: sam. 14 mai 2016
        </abbr>

        <address class="vcard author">
                By                         <a class="url fn" href="/author/gael.html">Gaël</a>
        </address>
<p>In <a href="/category/data-processing.html">Data processing</a>.</p>

</footer><!-- /.post-info -->      <p>Have you ever been given a choice that you found very hard to make?
In some situations, that choice is hard because you don&rsquo;t like any of the
outcomes.
In other situations, it is hard because you just <strong>don&rsquo;t know</strong> what these
outcomes would be. In that latter case, you would generally try to
predict<todo:link modelling="" to="">
what these outcomes would be either using pure intuition, common sense,
your knowledge and experience, or even fancy mathematical&nbsp;stuff.</todo:link></p>
<p>In the web-service realm, there is one such a question that haunts a lot of
people, day after day, and even at night in their worst&nbsp;nightmares:</p>
<blockquote>
<p>Is there anything we can do to make more money out of my&nbsp;website?</p>
</blockquote>
<h1 id="website-optimization">Website&nbsp;optimization</h1>
<p><em>What is he talking about?</em> could you ingenuously say&hellip; People, like a lot
of other things, tend to react the same way <em>on average</em> given the same
stimulus: people tend to take an umbrella or a rain coat with them when it
is raining. Nothing really surprising&nbsp;there.</p>
<p>But did you know that a simple <a href="http://dx.doi.org/10.1111/j.1745-459X.2012.00397.x">cup color could change the way you taste
chocolate</a>?
In a very similar way, changing a simple button color on a website for instance
could increase the total number of clicks, yielding more incomes. The process
of finding such an
optimal design is called <em>website optimization</em>.</p>
<h1 id="of-time-machines-and-statistics">Of time machines and&nbsp;statistics</h1>
<p>But how do we know that one variant yields a higher reward? Strictly speaking,
knowing it <em>exactly</em> would require a time machine to test all the variants in
the <em>exact</em> same conditions. In one timeline, you could provide the first
variant. In the other timeline you could provide the alternative variant and
then use your time machine a last time to settle on the best-performing&nbsp;variant.</p>
<p>However, if we can afford to be wrong <em>sometimes</em>,
there is another way to answer that question without breaking any
physical law: <em>statistics</em><todo:link statistics="" to="">.</todo:link></p>
<p>In our button color example we want to get the maximum number
of clicks. This is our objective as well as our reward.
That number of click is not easy to handle: obviously if 5 people out of 10
clicked, it is not the same as 5 people out of 10000. That is why we are really
looking at is the click-through rate: the number of people who clicked over the
number of people who visited the&nbsp;website.</p>
<p>However, if you spend your time (and your visitors) assessing which variant is
performing the best, your reward (i.e. total number of clicks) might be rather
disappointing. This is why the testing campaign is usually performed on a
subset of the total visitor <strong>population</strong>. That subset is called a <strong>sample</strong>
of the population. That sample will be subjected to each variant of the
website, in our&nbsp;example:</p>
<ul>
<li>one variant of the website, would contain an orange
<img alt="*Buy Now!*" src="/images/orange_btn.svg"/>&nbsp;button</li>
<li>while the other variant would contain a green 
<img alt="" src="/images/green_btn.svg"/>&nbsp;one.</li>
</ul>
<p>Once the testing period is over, the seemingly best-performing variant is
served to all the remaining visitors (this is sometimes called the exploitation&nbsp;period).</p>
<p><span class="dquo">&ldquo;</span>Problem solved!&rdquo; you said? Unfortunately, nope. At this stage, we have only
reached a precision which is akin to &ldquo;people die from hunger, so let&rsquo;s give
them food&rdquo;: if this was enough, people wouldn&rsquo;t die from hunger anymore.
The devil<strong>s</strong> are in the details: how large should that sample be?
how often are we expecting to be wrong? how should be provide the variants
exactly? <em>etc.</em></p>
<p>This is exactly why some <em>specific</em> methods were devised,
such as A/B testing (<a href="https://en.wikipedia.org/wiki/A/B_testing">wiki</a>)
and the 
multi-armed bandit strategy 
(<a href="https://en.wikipedia.org/wiki/Multi-armed_bandit">wiki</a>). And these are the
one I am going to&nbsp;study.</p>
<p>If that part is not clear enough, here is a longer&nbsp;description.</p>
<h1 id="ab-testing">A/B&nbsp;testing</h1>
<p>The purpose for which A/B testing was designed is to answer a single&nbsp;question:</p>
<blockquote>
<p>Is any of my variants (i.e. <img alt="the orange" src="/images/orange_btn.svg"/>
and <img alt="the green button in our example" src="/images/green_btn.svg"/>) 
inducing a significantly different outcome (i.e. click-through rate&nbsp;here)?</p>
</blockquote>
<p>As explained above, A/B testing<todo: details="" link="" to=""> is a two-staged&nbsp;method:</todo:></p>
<ol>
<li><em>Testing stage</em>: this is where the data-gathering and analysis take&nbsp;place.</li>
<li><em>Exploitation stage</em>: this is where only the best-performing variant is&nbsp;served.</li>
</ol>
<p>Proper A/B testing requires all the variants to be served almost as often at
any point of time. Even though this is in no way a hard requirement, we will
see that is is actually a very efficient way to get the highest confidence in
our&nbsp;data.</p>
<p>So where is the &ldquo;testing&rdquo; of <em>A/B testing</em> coming from? The actual testing is
performed at the end of the <em>testing stage</em> to provide an actual answer to the
question above. That test in called a <em>contingency test</em> and for this kind of
<em>Bernoulli processes</em> (i.e. binary data like &ldquo;has clicked or not?&rdquo;) we are
going to use <em>Fisher&rsquo;s exact test</em>
(<a href="https://en.wikipedia.org/wiki/Fisher's_exact_test">wiki</a>).</p>
<p>Why is such a test important? Because it answers the question above while
providing an estimate of what we could call <em>confidence</em>. With A/B testing we
can&nbsp;say:</p>
<blockquote>
<p>We proved that the green button yields higher click-through rates with only
a <span class="math">\(1\%\)</span> chance of being wrong&nbsp;here.</p>
</blockquote>
<p>This is a very precious piece of information if the existence of a difference
matters (like in drug trials to name&nbsp;one).</p>
<h1 id="the-multi-armed-bandit-method">The multi-armed bandit&nbsp;method</h1>
<p>The multi-armed bandit method was allegedly designed for only one&nbsp;purpose:</p>
<blockquote>
<p>Maximizing the reward (i.e. the total number of clicks in our case&nbsp;study).</p>
</blockquote>
<p>The particular multi-armed bandit strategy presented
in the original blog post was not specifically designed in a two-staged 
fashion (even though it <em>could</em> be used that way). 
It was instead presented in a <em>set-and-forget</em> mode, in
which there is no testing stage: the method is applied on the total&nbsp;population.</p>
<p>It works by first determining which variant worked the best so far. That
variant is then favoured and is served more often than the alternative.
The instant another variant is found better (as more data are gathered),
it is served more&nbsp;often.</p>
<p>In contrast with A/B testing, there seem to be no fool-proof way to estimate
a suitable sample size without making a few assumptions. In that sense, the
set-and-forget mode is more a workaround than a feature of the&nbsp;method.</p>
<p>There is also no test associated with that strategy. A contingency test could
be applied but we will see that there are drawbacks to&nbsp;that.</p>
<p>To sum it up, the multi-armed bandit method is more accurately described as a
strategy: it does not answer any question. This is generally not a problem
because the sample sizes people use are usually large enough to provide <strong>a</strong>
correct&nbsp;answer.</p>
<h1 id="main-differences-between-the-methods">Main differences between the&nbsp;methods</h1>
<p>In practice, both methods could be used in the <em>two-stepped</em> mode and a
contingency test can be performed in&nbsp;both.</p>
<p>However, in contrast with a few claims of the original blog&nbsp;post:</p>
<ul>
<li>A/B testing is only a specific name given to a 2-variant <strong>bucket tests</strong> 
    (<span class="math">\(A\)</span> and <span class="math">\(B\)</span>, you guessed it). However nothing prevents us
    from using it on more variants (Fisher&rsquo;s exact test can be used on any
    number of variants or all the variants can be compared&nbsp;2-by-2).</li>
<li>Variants can be added or removed any time. In particular, A/B
    testing does not <em>require</em> the variants to be served as often to work.
    However, serving them as often at any given time is actually more efficient
    and prevents a whole class of biases (I will come to that&nbsp;later).</li>
</ul>
<p>So what is the real core&nbsp;difference?</p>
<blockquote>
<p>A/B testing serves each variant as often whereas the <span class="caps">MAB</span> strategy favours&nbsp;one.</p>
</blockquote>
<p>That&rsquo;s&nbsp;it.</p>
<script type="text/javascript">if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) {
    var align = "center",
        indent = "0em",
        linebreak = "false";

    if (false) {
        align = (screen.width < 768) ? "left" : align;
        indent = (screen.width < 768) ? "0em" : indent;
        linebreak = (screen.width < 768) ? 'true' : linebreak;
    }

    var mathjaxscript = document.createElement('script');
    var location_protocol = (false) ? 'https' : document.location.protocol;
    if (location_protocol !== 'http' && location_protocol !== 'https') location_protocol = 'https:';
    mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#';
    mathjaxscript.type = 'text/javascript';
    mathjaxscript.src = location_protocol + '//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML';
    mathjaxscript[(window.opera ? "innerHTML" : "text")] =
        "MathJax.Hub.Config({" +
        "    config: ['MMLorHTML.js']," +
        "    TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } }," +
        "    jax: ['input/TeX','input/MathML','output/HTML-CSS']," +
        "    extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']," +
        "    displayAlign: '"+ align +"'," +
        "    displayIndent: '"+ indent +"'," +
        "    showMathMenu: true," +
        "    messageStyle: 'normal'," +
        "    tex2jax: { " +
        "        inlineMath: [ ['\\\\(','\\\\)'] ], " +
        "        displayMath: [ ['$$','$$'] ]," +
        "        processEscapes: true," +
        "        preview: 'TeX'," +
        "    }, " +
        "    'HTML-CSS': { " +
        "        styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'inherit ! important'} }," +
        "        linebreaks: { automatic: "+ linebreak +", width: '90% container' }," +
        "    }, " +
        "}); " +
        "if ('default' !== 'default') {" +
            "MathJax.Hub.Register.StartupHook('HTML-CSS Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax['HTML-CSS'].FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
            "MathJax.Hub.Register.StartupHook('SVG Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax.SVG.FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
        "}";
    (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript);
}
</script>
    </div><!-- /.entry-content -->

  </article>
</section>
        <section id="extras" class="body">
        </section><!-- /#extras -->

        <footer id="contentinfo" class="body">
                <address id="about" class="vcard body">
                Proudly powered by <a href="http://getpelican.com/">Pelican</a>, which takes great advantage of <a href="http://python.org">Python</a>.
                </address><!-- /#about -->

                <p>The theme is by <a href="http://coding.smashingmagazine.com/2009/08/04/designing-a-html-5-layout-from-scratch/">Smashing Magazine</a>, thanks!</p>
        </footer><!-- /#contentinfo -->

</body>
</html>